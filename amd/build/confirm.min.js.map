{"version":3,"sources":["../src/confirm.js"],"names":["define","$","ModalFactory","String","ModalEvents","Ajax","Notification","trigger","create","type","types","SAVE_CANCEL","title","get_string","body","preShowCallback","triggerElement","modal","message_id","data","params","setSaveButtonText","done","getRoot","on","save","e","preventDefault","Y","log","request","methodname","args","footer","one","setContent","spinner","M","util","add_spinner","show","call","window","location","reload","addNotification","message","fail","exception"],"mappings":"AAQAA,OAAM,yBAAC,CAAC,QAAD,CAAW,oBAAX,CAAgC,UAAhC,CAA2C,mBAA3C,CAA+D,WAA/D,CAA2E,mBAA3E,CAAD,CACN,SAASC,CAAT,CAAYC,CAAZ,CAAyBC,CAAzB,CAAgCC,CAAhC,CAA4CC,CAA5C,CAAiDC,CAAjD,CAA+D,CAC3D,GAAIC,CAAAA,CAAO,CAAGN,CAAC,CAAC,8BAAD,CAAf,CACAC,CAAY,CAACM,MAAb,CAAoB,CAClBC,IAAI,CAAEP,CAAY,CAACQ,KAAb,CAAmBC,WADP,CAElBC,KAAK,CAAET,CAAM,CAACU,UAAP,CAAkB,gBAAlB,CAAmC,eAAnC,CAFW,CAGlBC,IAAI,CAAEX,CAAM,CAACU,UAAP,CAAkB,wBAAlB,CAA2C,eAA3C,CAHY,CAIlBE,eAAe,CAAE,yBAACC,CAAD,CAAgBC,CAAhB,CAAyB,IAClCD,CAAAA,CAAc,CAAGf,CAAC,CAACe,CAAc,CAAC,CAAD,CAAf,CADgB,CAElCE,CAAU,CAAGF,CAAc,CAACG,IAAf,CAAoB,IAApB,CAFqB,CAGtCF,CAAK,CAACG,MAAN,CAAe,CAAC,WAAaF,CAAd,CAAf,CACAD,CAAK,CAACI,iBAAN,CAAwBlB,CAAM,CAACU,UAAP,CAAkB,gBAAlB,CAAmC,eAAnC,CAAxB,CACH,CATiB,CAApB,CAUGN,CAVH,EAWCe,IAXD,CAWM,SAASL,CAAT,CAAgB,CAEpBA,CAAK,CAACM,OAAN,GAAgBC,EAAhB,CAAmBpB,CAAW,CAACqB,IAA/B,CAAqC,SAACC,CAAD,CAAM,CACvCA,CAAC,CAACC,cAAF,GAEAC,CAAC,CAACC,GAAF,CAAMZ,CAAK,CAACG,MAAZ,EAHuC,GAKnCU,CAAAA,CAAO,CAAG,CACVC,UAAU,CAAE,8BADF,CAEVC,IAAI,CAACf,CAAK,CAACG,MAFD,CALyB,CAUnCa,CAAM,CAAGL,CAAC,CAACM,GAAF,CAAM,eAAN,CAV0B,CAWvCD,CAAM,CAACE,UAAP,CAAkB,aAAlB,EACA,GAAIC,CAAAA,CAAO,CAAGC,CAAC,CAACC,IAAF,CAAOC,WAAP,CAAmBX,CAAnB,CAAqBK,CAArB,CAAd,CACAG,CAAO,CAACI,IAAR,GACAnC,CAAI,CAACoC,IAAL,CAAU,CAACX,CAAD,CAAV,EAAqB,CAArB,EAAwBR,IAAxB,CAA6B,SAACH,CAAD,CAAU,CAEnC,GAAG,KAAAA,CAAH,CAAiB,CACfuB,MAAM,CAACC,QAAP,CAAgBC,MAAhB,EACD,CAFD,IAGI,CACAtC,CAAY,CAACuC,eAAb,CAA6B,CACzBC,OAAO,CAAE3C,CAAM,CAACU,UAAP,CAAkB,wBAAlB,CAA2C,eAA3C,CADgB,CAEzBJ,IAAI,CAAE,OAFmB,CAA7B,CAIH,CACJ,CAXD,EAWGsC,IAXH,CAWQzC,CAAY,CAAC0C,SAXrB,CAaH,CA3BD,CA4BD,CAzCD,CA0CD,CA7CG,CAAN","sourcesContent":["// Standard license block omitted.\n/*\n * @module     local_message/confirm\n * @copyright  2022 Someone cool\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n\ndefine(['jquery', 'core/modal_factory','core/str','core/modal_events','core/ajax','core/notification'],\nfunction($, ModalFactory,String,ModalEvents,Ajax,Notification) {\n    var trigger = $('.local_message_delete_button');\n    ModalFactory.create({\n      type: ModalFactory.types.SAVE_CANCEL,\n      title: String.get_string('delete_message','local_message'),\n      body: String.get_string('delete_message_confirm','local_message'),\n      preShowCallback: (triggerElement,modal) =>{\n          var triggerElement = $(triggerElement[0]);\n          let message_id = triggerElement.data('id');\n          modal.params = {'message_id':message_id};\n          modal.setSaveButtonText(String.get_string('delete_message','local_message'));\n      }\n    }, trigger)\n    .done(function(modal) {\n      // Do what you want with your new modal.\n      modal.getRoot().on(ModalEvents.save, (e) =>{\n          e.preventDefault();\n\n          Y.log(modal.params);\n\n          let request = {\n              methodname: 'local_message_delete_message',\n              args:modal.params\n          };\n\n          let footer = Y.one('.modal-footer');\n          footer.setContent('Deleting...');\n          let spinner = M.util.add_spinner(Y,footer);\n          spinner.show();\n          Ajax.call([request])[0].done((data) => {\n              //spinner.hide();\n              if(data === true){\n                window.location.reload();\n              }\n              else{\n                  Notification.addNotification({\n                      message: String.get_string('error_deleting_message','local_message'),\n                      type: 'error'\n                  });\n              }\n          }).fail(Notification.exception);\n\n      });\n    });\n  });"],"file":"confirm.min.js"}